# tg_support_bot

**Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏—ë–º–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π –≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–∞–Ω–∏–∏.**

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–º—É email (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ –±–µ–ª–æ–º—É —Å–ø–∏—Å–∫—É)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö email-–∞–¥—Ä–µ—Å–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
- –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram-–≥—Ä—É–ø–ø—É –∏/–∏–ª–∏ –Ω–∞ email
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π, —à–∞–±–ª–æ–Ω–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ YAML-—Ñ–∞–π–ª—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Jinja2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞ –∏ HTML-–ø–∏—Å–µ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª –∏ –∫–æ–Ω—Å–æ–ª—å

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.9 –∏–ª–∏ –≤—ã—à–µ.

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/yourname/tg_support_bot.git
   cd tg_support_bot
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```bash
   python -m venv venv
   call venv\Scripts\activate  # Windows
   source venv/bin/activate    # Linux/macOS
   ```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
setup.bat
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

–î–ª—è –∑–∞–ø—É—Å–∫–∞ Telegram-–±–æ—Ç–∞:

```bash
start_bot.bat      # Windows
./start_bot.sh     # Linux/macOS
```

–î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ email:

```bash
start_test_email.bat
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### `.env`

–í —Ñ–∞–π–ª–µ `.env` —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```dotenv
BOT_TOKEN=your_bot_token
EMAIL_SENDER=bot@yourcompany.com
EMAIL_PASSWORD=app_password
SMTP_SERVER=smtp.yourcompany.com
SMTP_PORT=587
SUPPORT_EMAIL=support@yourcompany.com
SUPPORT_CHAT_ID=-1001234567890
LOG_LEVEL=DEBUG
```

### `config/auth.yaml`

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```yaml
auth:
  email_pattern: "^[a-zA-Z0-9_.+-]+@yourcompany\.com$"
  email_autocomplete: "@yourcompany.com"
  allow_incomplete_input: true
  send_welcome_before_topic: true
  send_topic_after_auth: true
  delay_after_auth_success: 2
```

### `config/ui_config.yaml`

–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ:
- –∫–æ–º–∞–Ω–¥—ã –º–µ–Ω—é,
- –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏,
- –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤,
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:

```yaml
telegram_menu:
  - command: start
    description: "–û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é"
  - command: help
    description: "–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É"
  - command: myid
    description: "–ü–æ–∫–∞–∑–∞—Ç—å ID –∏ email (–µ—Å–ª–∏ –µ—Å—Ç—å)"

telegram_start:
  show_action_button_if_authorized: true
  action_button_text: "üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ"

authorization:
  confirm_change_buttons:
    yes: "‚úÖ –î–∞"
    no: "‚ùå –ù–µ—Ç"

  email_status_labels:
    allowed: "‚úÖ –†–∞–∑—Ä–µ—à—ë–Ω"
    banned: "üö´ –ó–∞–±–∞–Ω–µ–Ω"

ticket_categories:
  - "üíª –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Å–±–æ–∏"
  - "üõ† –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –æ—à–∏–±–∫–∏"
  - "üåê –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã"
  - "üîë –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ—Å—Ç—É–ø"
  - "üõ° –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"
  - "‚ùó –ñ–∞–ª–æ–±–∞/–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å"
  - "üìÅ –î—Ä—É–≥–æ–µ"

message_limits:
  max_submission_length: 1500
```

## üìÅ –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

–§–∞–π–ª—ã —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `templates/`. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≥–∏–±–∫–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏–π:

| –§–∞–π–ª                    | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------------------------|------------|
| auth_start.txt          | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏ –≤—Ö–æ–¥–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω |
| auth_success.txt        | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| auth_already.txt        | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω |
| auth_not_registered.txt | Email –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ |
| auth_banned.txt         | Email –≤ –±–∞–∑–µ, –Ω–æ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |
| auth_invalid.txt        | –í–≤–µ–¥—ë–Ω –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email |
| auth_change_confirm.txt | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–º–µ–Ω—ã email |
| auth_changed.txt        | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π —Å–º–µ–Ω–µ email |
| auth_change_cancelled.txt | –°–º–µ–Ω–∞ email –æ—Ç–º–µ–Ω–µ–Ω–∞ |
| welcome_user.txt        | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| select_topic.txt        | –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è |
| enter_message.txt       | –ü—Ä–æ—Å—å–±–∞ –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è |
| invalid_topic.txt       | –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| invalid_input.txt       | –í–≤–µ–¥–µ–Ω–æ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É/–Ω–µ –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç |
| message_too_long.txt    | –°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ |
| ticket_sent.txt         | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è |
| ticket_summary.txt      | –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–µ –≤ Telegram –∏/–∏–ª–∏ email |
| email_added.txt         | –£—Å–ø–µ—à–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ email |
| email_banned.txt        | –£—Å–ø–µ—à–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ email |
| email_removed.txt       | –£—Å–ø–µ—à–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ email |
| email_required.txt      | Email –Ω–µ —É–∫–∞–∑–∞–Ω –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –∫–æ–º–∞–Ω–¥—ã |
| email_status_found.txt  | –°—Ç–∞—Ç—É—Å —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ email (—Ä–∞–∑—Ä–µ—à—ë–Ω/–∑–∞–±–∞–Ω–µ–Ω) |
| email_status_not_found.txt | Email –Ω–µ –Ω–∞–π–¥–µ–Ω |
| my_id.txt               | –°–æ–æ–±—â–µ–Ω–∏–µ —Å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ email (–µ—Å–ª–∏ –µ—Å—Ç—å) |
| not_authorized.txt      | –û—à–∏–±–∫–∞: –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º |
| help_user.txt           | –°–ø—Ä–∞–≤–∫–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| help_admin.txt          | –°–ø—Ä–∞–≤–∫–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ |
| support_email.html      | HTML-—à–∞–±–ª–æ–Ω email —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |

## –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ pyproject.toml

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `pyproject.toml`, –¥–æ—Å—Ç—É–ø–µ–Ω CLI:

```bash
tg-support-bot
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
